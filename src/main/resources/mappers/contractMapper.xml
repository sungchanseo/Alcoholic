<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.itwillbs.mappers.contractMapper">
<!-- contract 상세보기  -->
	<select id="readContractInfo" resultType="ContractVO">
		SELECT * FROM contract 
		WHERE cont_id = #{cont_id}
	</select>
<!-- contract 상세보기  -->
	
<!-- contract 등록하기 	 -->
	<insert id="insertContract">
	INSERT INTO contract (cont_id, product_name, product_id, cust_id, cust_name,
	cont_date, cont_qty, due_date, production_id, cont_emp, cont_status)
	VALUES(#{cont_id}, #{product_name}, #{product_id}, #{cust_id}, #{cust_name}, 
	#{cont_date}, #{cont_qty}, #{due_date}, #{production_id}, #{cont_emp},
	0)
	</insert>
<!-- contract 등록하기 	 -->

<!-- cont_id 자동 카운트 -->
 	<select id="getLastGeneratedNumber" resultType="java.lang.String">
        SELECT cont_id FROM contract ORDER BY cont_id DESC LIMIT 1
    </select>
<!-- cont_id 자동 카운트 -->


<!-- contract 수정하기 -->
	<update id="updateContract">
	UPDATE contract SET cust_name=#{cust_name},
	product_id=#{product_id}, product_name=#{product_name},
	cust_id=#{cust_id}, cont_date=#{cont_date}, cont_qty=#{cont_qty},
	due_date=#{due_date}, cont_emp=#{cont_emp}
	WHERE cont_id=#{cont_id}
	</update>
<!-- contract 수정하기 -->
	
<!-- contract 삭제하기 	 -->
	<update id="deleteContract">
		UPDATE contract SET cont_status=1
		WHERE cont_id=#{cont_id}
	</update>
<!-- contract 삭제하기 	 -->

<!-- cont_id를 out_product테이블에 넣기 -->
	<insert id="contIdInsert">
		insert into out_product (cont_id) 
		values (#{cont_id})
	</insert>
<!-- cont_id를 out_product테이블에 넣기 -->

<!-- 상품 상세정보 조회 -->
	<select id="getProductInfo" resultType="ProductionVO">
		select * from product 
		where product_id = #{product_id}
	</select>
<!-- 상품 상세정보 조회 -->


<!-- 페이징처리  -->

	<!--  	전체 리스트 갯수 조회  -->
		<select id="getListAll" resultType="_int">
			SELECT COUNT(*) FROM ${table} 
			WHERE ${status_name}=#{status_value}
		</select>
	<!-- 	전체 리스트 갯수 조회  -->
	
	<!-- 아무조건이 없을 때 목록갯수 가져오기  -->
		<select id="getListPageSizeAll" resultType="_int">
			SELECT COUNT(*) FROM ${table} 
			WHERE ${status_name}=#{status_value} 
			limit #{startRow}, #{pageSize} 
		</select>
	<!-- 아무조건이 없을 때 목록갯수 가져오기  -->
	
	<!--  	검색어+페이지갯수 제한 전체 목록 갯수 가져오기  -->
		<select id="getListSearchAll" resultType="_int">
			SELECT COUNT(*) FROM ${table}
			WHERE  ${status_name}=#{status_value}
			AND ${selector} LIKE CONCAT('%', #{search}, '%')
		</select>
	<!--  	검색어+페이지갯수 제한 전체 목록 갯수 가져오기  -->
	
	<!-- 아무조건이 없을 때 목록 배열 가져오기  -->
		<select id="getListPageSizeObjectContractVO" resultType="ContractVO">
			SELECT * FROM ${table} 
			WHERE ${status_name} = #{status_value} 
			ORDER BY ${id} DESC LIMIT #{startRow}, #{pageSize}
		</select>
	<!-- 아무조건이 없을 때 목록갯수 가져오기  -->	
		
	<!--  	검색어+페이지갯수 제한 전체 목록 배열 가져오기  -->
		<select id="getListSearchObjectContractVO" resultType="ContractVO">
			SELECT * FROM ${table} 
			WHERE ${status_name} = #{status_value}
			AND ${selector} LIKE CONCAT('%', #{search}, '%') 
			ORDER BY ${id} DESC LIMIT #{startRow}, #{pageSize}
		</select>
	<!--  	검색어+페이지갯수 제한 전체 목록 배열 가져오기  -->	

<!-- 페이징처리  -->

	
</mapper>